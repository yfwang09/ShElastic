% test case (not sure what it tests, seems to be a strange structure)

global Bscrew Bedge Beclimb Bline


rn = [1449.7666 1414.8997 -3140.8808 0;
      1448.3143 1418.6856 -3140.0013 0;
      1445.0038 1388.1824 -3148.8792 0;
      1452.4430 1401.6566 -3145.2559 0;
      1501.7425 1230.6590 -3189.8163 0;
      1382.3511 1197.1829 -3152.6213 7;
      1392.8569 1382.9543 -3163.2591 7;
      1462.8166 1457.9243 -3182.3887 7;
      1514.3030 1069.7976 -3190.3368 7;
      1491.5358 1603.7097 -3051.8862 7;
      1369.2668 1576.5994 -3060.7133 7];

links = [1 2 1.1547006000 1.1547006000 1.1547006000 0.4534148982 0.3613496890 -0.8147645871;
         1 3 -0.5773503000 -0.5773503000 -0.5773503000 0.5692866073 0.2222438327 -0.7915304401;
         1 4 -0.5773503000 -0.5773503000 -0.5773503000 0.4726441556 0.3402675740 -0.8129117297;
         2 10 0.5773503000 0.5773503000 0.5773503000 0.5428143937 0.2568109403 -0.7996253341;
         2 8 0.5773503000 0.5773503000 -0.5773503000 -0.8144710668 0.3574594240 -0.4570116427;
         2 11 -0.0000000000 -0.0000000000 1.1547006000 0.8947338989 0.4465996532 0.0000000000;
         3 4 0.5773503000 0.5773503000 -0.5773503000 -0.7995649886 0.2565279247 -0.5430370639;
         3 6 -0.5773503000 -0.5773503000 0.5773503000 -0.8094343096 0.3119158952 -0.4975184144;
         3 7 -0.5773503000 -0.5773503000 -0.5773503000 -0.1832805397 -0.5974215436 0.7807020834;
         4 5 0.0000000000 0.0000000000 -1.1547006000 0.8953769234 0.4453090669 0.0000000000;
         5 9 0.5773503000 0.5773503000 -0.5773503000 -0.6677079925 -0.0731159383 0.7408239308;
         5 8 -0.5773503000 -0.5773503000 -0.5773503000 -0.4513408776 -0.3635821039 0.8149229816];
         

MU = 1.3e+11;
NU = 0.309;
maxconnections=8;
lmax = 300;
lmin = 50;
areamin=lmin*lmin*sin(60/180*pi)*0.5; 
areamax=20*areamin;
a=lmin/sqrt(3)*0.5;
Ec = MU/(4*pi)*log(a/0.1);
totalsteps=200;
dt0=1e7;  
mobility='mobbcc0';
%Drag (Mobility) parameters
Bscrew=1e0;
Bedge=1e0;
Beclimb=1e2;
Bline=1.0e-4*min(Bscrew,Bedge);

integrator='int_trapezoid';
rann = 2.5;       
rntol = 1.25;    
doremesh=1;
docollision=1;
doseparation=1;
plotfreq=1;       
plim=10000;         
appliedstress = [1.172824e+01 3.392878e+00 -1.166893e+04;
                 3.392878e+00 -3.949308e-01 1.410441e+04;
                 -1.166893e+04 1.410441e+04 3.577510e+08];
viewangle=[45 45 ];
printfreq=1;      
printnode=3;
rmax=100;

% simulation box size (for paradis)
L = 40000;
minSideX = -L/2;
minSideY = -L/2;
minSideZ = -L/2;
maxSideX =  L/2;
maxSideY =  L/2;
maxSideZ =  L/2;

% boundary conditions (for paradis)
xBoundType = 1; % free
yBoundType = 1; % free
zBoundType = 1; % free

% output and communication settings
paradis_dir = '../..';
paradis_input_dir = strcat(paradis_dir,'/Runs');
paradis_output_dir = strcat('Outputs/frank_read_results'); 

